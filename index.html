<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2015-03-27 
 | Rendered using Apache Maven Fluido Skin 1.3.1
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20150327" />
    <meta http-equiv="Content-Language" content="en" />
    <title>java-iod-client &#x2013; java-iod-client</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.1.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.1.min.js"></script>

    
                  </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/hpautonomy/java-iod-client">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>java-iod-client</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2015-03-27
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 0.4.0
                      </li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                          
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-down"></i>
        Project Information</a>
                    <ul class="nav nav-list">
                    
      <li class="active">
  
            <a href="#"><i class="none"></i>About</a>
          </li>
                    
      <li>
  
                          <a href="project-summary.html" title="Project Summary">
          <i class="none"></i>
        Project Summary</a>
            </li>
                    
      <li>
  
                          <a href="dependency-info.html" title="Dependency Information">
          <i class="none"></i>
        Dependency Information</a>
            </li>
                    
      <li>
  
                          <a href="license.html" title="Project License">
          <i class="none"></i>
        Project License</a>
            </li>
                    
      <li>
  
                          <a href="team-list.html" title="Project Team">
          <i class="none"></i>
        Project Team</a>
            </li>
                    
      <li>
  
                          <a href="source-repository.html" title="Source Repository">
          <i class="none"></i>
        Source Repository</a>
            </li>
                    
      <li>
  
                          <a href="issue-tracking.html" title="Issue Tracking">
          <i class="none"></i>
        Issue Tracking</a>
            </li>
                    
      <li>
  
                          <a href="dependencies.html" title="Dependencies">
          <i class="none"></i>
        Dependencies</a>
            </li>
                    
      <li>
  
                          <a href="plugin-management.html" title="Plugin Management">
          <i class="none"></i>
        Plugin Management</a>
            </li>
                    
      <li>
  
                          <a href="plugins.html" title="Project Plugins">
          <i class="none"></i>
        Project Plugins</a>
            </li>
                    
      <li>
  
                          <a href="distribution-management.html" title="Distribution Management">
          <i class="none"></i>
        Distribution Management</a>
            </li>
                    
      <li>
  
                          <a href="apidocs/index.html" title="API Javadoc">
          <i class="none"></i>
        API Javadoc</a>
            </li>
              </ul>
        </li>
                                                                                                
      <li>
  
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-down"></i>
        Project Reports</a>
                    <ul class="nav nav-list">
                    
      <li>
  
                          <a href="changes-report.html" title="Changelist">
          <i class="none"></i>
        Changelist</a>
            </li>
                    
      <li>
  
                          <a href="surefire-report.html" title="Test Results">
          <i class="none"></i>
        Test Results</a>
            </li>
                    
      <li>
  
                          <a href="failsafe-report.html" title="Integration Test Results">
          <i class="none"></i>
        Integration Test Results</a>
            </li>
              </ul>
        </li>
            </ul>
                
                    
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <h1>java-iod-client</h1>
<p>Java Client for communicating with <a class="externalLink" href="http://www.idolondemand.com">IDOL OnDemand</a></p>
<div class="section">
<h2><a name="About"></a>About</h2>
<p>java-iod-client provides a Java Interface to the IDOL OnDemand APIs to simplify calling the IDOL OnDemand APIs from Java, allowing consumers of java-iod-client to access IDOL OnDemand in a typesafe way.</p></div>
<div class="section">
<h2><a name="Goals"></a>Goals</h2>
<p>Currently only a small subset of IDOL OnDemand APIs are supported. The eventual aim to support all the IDOL OnDemand APIs. We also plan to provide support for asynchronous APIs, and automated error handling of IDOL OnDemand error codes.</p>
<p>If an API you need is not supported, submit a pull request!</p></div>
<div class="section">
<h2><a name="Usage"></a>Usage</h2>
<p>java-iod-client is available from the central Maven repository.</p>

<div class="source">
<div class="source">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;com.hp.autonomy.iod&lt;/groupId&gt;
    &lt;artifactId&gt;java-iod-client&lt;/artifactId&gt;
    &lt;version&gt;0.4.0&lt;/version&gt;
&lt;/dependency&gt;
</pre></div></div>
<p>java-iod-client uses <a class="externalLink" href="http://square.github.io/retrofit/">Retrofit</a> as the basis of its HTTP implementation. This requires the use of a RestAdapter to use the services. We have used <a class="externalLink" href="https://github.com/FasterXML/jackson">Jackson</a> for JSON transformation, so you will need to use the Jackson Converter. To send multipart requests to IDOL OnDemand correctly, you will need to wrap this in an IodConverter. An error handler is supplied for parsing error responses from IDOL OnDemand.</p>

<div class="source">
<div class="source">
<pre>final RestAdapter restAdapter = new RestAdapter.Builder()
    .setEndpoint(&quot;https://api.idolondemand.com/1&quot;)
    .setConverter(new IodConverter(new JacksonConverter()))
    .setErrorHandler(new IodErrorHandler())
    .build();

final QueryTextIndexService queryTextIndexService = restAdapter.create(QueryTextIndexService.class);
</pre></div></div>
<p>You can then call the methods on queryTextIndexService to communicate with IDOL OnDemand.</p>

<div class="source">
<div class="source">
<pre>final Map&lt;String, Object&gt; params = new QueryTextIndexRequestBuilder()
    .setAbsoluteMaxResults(10)
    .setTotalResults(true)
    .setIndexes(&quot;wiki_eng&quot;)
    .build();

final Documents documents = queryTextIndexService.queryTextIndexWithText(
    &quot;myApiKey&quot;,
    &quot;cats&quot;,
    params);
</pre></div></div></div>
<div class="section">
<h2><a name="Library_structure"></a>Library structure</h2>
<p>APIs can be found in the com.hp.autonomy.iod.client.api package. There is one package per category as seen in the IDOL OnDemand documentation. There is one service per API.</p></div>
<div class="section">
<h2><a name="Asynchronous_requests"></a>Asynchronous requests</h2>
<p>For asynchronous actions the Retrofit service returns a JobId. We also provide a service which will track the status of the job IDs.</p>

<div class="source">
<div class="source">
<pre>final AddToTextIndexJobService addToTextIndexService = new AddToTextIndexJobService(restAdapter.create(AddToTextIndexJobService.class));
</pre></div></div>
<p>The methods on this service take a callback which will be called when the job is completed</p>

<div class="source">
<div class="source">
<pre>addToTextIndexService.addFileToTextIndex(getApiKey(), file, getIndex(), params, new IodJobCallback&lt;AddToTextIndexResponse&gt;() {
    @Override
    public void success(final AddToTextIndexResponse result) {
        // called if the job succeeds
    }

    @Override
    public void error(final IodErrorCode error) {
        // called if the job fails
    }

    @Override
    public void handleException(final RuntimeException exception) {
        // called if a RuntimeException is thrown during the process
    }
});
</pre></div></div>
<p>The APIs which are currently asynchronous are</p>

<ul>
  
<li>AddToTextIndex</li>
  
<li>DeleteFromTextIndex</li>
</ul></div>
<div class="section">
<h2><a name="Request_Interceptors"></a>Request Interceptors</h2>
<p>For cases where you want to send the same API key with every request, we provide RequestInterceptors. These are configured when the RestAdapter is created. Most API methods have a version which does not take an API, which can be used in conjunction with a request interceptor.</p>

<div class="source">
<div class="source">
<pre>// set up a RestAdapter using a request interceptor
final RestAdapter restAdapter = new RestAdapter.Builder()
    .setEndpoint(&quot;https://api.idolondemand.com/1&quot;)
    .setConverter(new IodConverter(new JacksonConverter()))
    .setErrorHandler(new IodErrorHandler())
    .setRequestInterceptor(new ApiKeyRequestInterceptor(apiKey))
    .build();

// query for documents using apiKey
final Documents documents = queryTextIndexService.queryTextIndexWithText(
    &quot;cats&quot;,
    params);
</pre></div></div>
<p>These have a couple of limitations:</p>

<ul>
  
<li>They will not add an API key to a multipart request, as IDOL OnDemand does not read query parameters on multipart requests. Service methods which send a multipart request are not overloaded to allow the omission of an API key</li>
  
<li>They will break any non-multipart requests which specify an API key. This is because the API key will be set twice, which makes IDOL OnDemand sad. In particular, job service methods which take an API key cannot be used as they will attempt to poll for job status with the given API key</li>
</ul>

<div class="source">
<div class="source">
<pre>// set up a RestAdapter using a request interceptor
final RestAdapter restAdapter = new RestAdapter.Builder()
    .setEndpoint(&quot;https://api.idolondemand.com/1&quot;)
    .setConverter(new IodConverter(new JacksonConverter()))
    .setErrorHandler(new IodErrorHandler())
    .setRequestInterceptor(new ApiKeyRequestInterceptor(apiKey))
    .build();

// BROKEN - this will generate an IodErrorException as the API key will be set twice
final Documents documents = queryTextIndexService.queryTextIndexWithText(
    &quot;someOtherApiKey&quot;
    &quot;cats&quot;,
    params);

// BROKEN - the initial request will succeed but polling for the job status will fail
addToTextIndexService.addFileToTextIndex(getApiKey(), file, getIndex(), params, new IodJobCallback&lt;AddToTextIndexResponse&gt;() {
    @Override
    public void success(final AddToTextIndexResponse result) {
        // called if the job succeeds
    }

    @Override
    public void error(final IodErrorCode error) {
        // called if the job fails
    }

    @Override
    public void handleException(final RuntimeException exception) {
        // called if a RuntimeException is thrown during the process
    }
});
</pre></div></div></div>
<div class="section">
<h2><a name="IdolOnDemandService"></a>IdolOnDemandService</h2>
<p>For those times where the API you need to use is not currently supported, there is the IdolOnDemand service. This can query any API.</p>

<div class="source">
<div class="source">
<pre>final IdolOnDemand service idolOnDemandService = restAdapter.create(IdolOnDemandService.class)

final Map&lt;String, Object&gt; params = new HashMap&lt;&gt;();
params.put(&quot;apiKey&quot;, apiKey);
params.put(&quot;text&quot;, &quot;*&quot;);

final Map&lt;String, Object&gt; result = idolOnDemandService.get(&quot;querytextindex&quot;, params);
</pre></div></div>
<p>This approach requires a greater familiarity with the IDOL OnDemand documentation. It also removes the type safety of the dedicated services, making the response useful only for automated transformation into JSON.</p></div>
<div class="section">
<h2><a name="Contributing"></a>Contributing</h2>
<p>We welcome pull requests. These must be licensed under the MIT license. Please submit pull requests to the develop branch - the develop branch is for stable code only.</p></div>
<div class="section">
<h2><a name="Is_it_any_good"></a>Is it any good?</h2>
<p>Yes.</p></div>
<div class="section">
<h2><a name="License"></a>License</h2>
<p>Copyright 2015 Hewlett-Packard Development Company, L.P.</p>
<p>Licensed under the MIT License (the &#x201c;License&#x201d;); you may not use this project except in compliance with the License.</p></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                              <p >Copyright &copy;                    2015
                        <a href="http://www.hp.com/">Hewlett-Packard Development Company, L.P.</a>.
            All rights reserved.      
                    
      </p>
        </div>

        
        
                </div>
    </footer>
        </body>
</html>
